import { useState, useEffect, useRef, useCallback } from "react";
var SU="https://rwlfbbmbustxpuvbakbo.supabase.co",SK="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ3bGZiYm1idXN0eHB1dmJha2JvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIwOTIwNDUsImV4cCI6MjA4NzY2ODA0NX0.9T_ia_s0XkVNz9P_nEtOsNzxWVVh-docYpOqLc8lgBU";
var SR=SU+"/rest/v1",HD={"apikey":SK,"Authorization":"Bearer "+SK,"Content-Type":"application/json","Prefer":"return=representation"};
async function db(t,m,p,b){var u=SR+"/"+t+(p||""),o={method:m||"GET",headers:Object.assign({},HD)};if(m==="POST"||m==="PATCH")o.headers["Prefer"]="return=representation";if(b)o.body=JSON.stringify(b);var r=await fetch(u,o);if(!r.ok){console.error("DB err:",await r.text());return null}var x=await r.text();return x?JSON.parse(x):null}
var nv="#132435",gd="#D0B48F",cp="#C78538",ol="#8C8135",gb="#CBD1DD",cr="#E9E9E2",gw="#808078",wh="#fff",ft="'Barlow Semi Condensed',sans-serif";
var APW="Clases2026",MXC=8,CB=4;
var SC={"San Isidro":["lunes-18:00","martes-09:30","martes-14:00","martes-18:30","mi√©rcoles-18:30","jueves-18:30","viernes-18:00","s√°bado-10:00"],"Palermo":["lunes-10:00","lunes-18:30","martes-14:30","martes-18:30","mi√©rcoles-18:30","jueves-14:30","jueves-18:30","viernes-10:00","viernes-18:30"]};
var DY=["lunes","martes","mi√©rcoles","jueves","viernes","s√°bado","domingo"];
var MN=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"];
function pMes(s){var l=s.toLowerCase();for(var i=0;i<MN.length;i++){if(l.includes(MN[i])){var y=l.match(/\d{4}/);return{month:i,year:y?parseInt(y[0]):new Date().getFullYear(),key:(y?parseInt(y[0]):new Date().getFullYear())+"-"+i}}}return null}
function cIM(day,time,mo,yr){var t=DY.indexOf(day),r=[],d=new Date(yr,mo,1);while(d.getMonth()===mo){var w=d.getDay(),x=w===0?6:w-1;if(x===t){var c=new Date(d),p=time.split(":");c.setHours(parseInt(p[0]),parseInt(p[1]),0,0);r.push(c)}d.setDate(d.getDate()+1)}return r}
function hU(d){return(d.getTime()-Date.now())/36e5}
function fD(d){var n=["dom","lun","mar","mi√©","jue","vie","s√°b"],m=["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"];return n[d.getDay()]+" "+d.getDate()+" "+m[d.getMonth()]+" ¬∑ "+String(d.getHours()).padStart(2,"0")+":"+String(d.getMinutes()).padStart(2,"0")}
function fDS(d){var n=["dom","lun","mar","mi√©","jue","vie","s√°b"];return n[d.getDay()]+" "+d.getDate()+"/"+(d.getMonth()+1)+" "+String(d.getHours()).padStart(2,"0")+":"+String(d.getMinutes()).padStart(2,"0")}
function gPw(p){return p+String(Math.floor(1000+Math.random()*9000))}
function bAl(r,pg,cn,ex){var mp={};pg.filter(function(p){return p.alumno_id===r.id}).forEach(function(p){mp[p.mes_key]=true});var ca=cn.filter(function(c){return c.alumno_id===r.id}).map(function(c){return{iso:c.fecha_iso,mk:c.mes_key,noR:c.sin_recuperacion,sinA:c.sin_aviso,isEx:c.is_extra}});var xe=ex.filter(function(e){return e.alumno_id===r.id}).map(function(e){return{date:e.fecha_iso,mk:e.mes_key,tipo:e.tipo}});return{id:r.id,nombre:r.nombre,tel:r.tel||"",email:r.email||"",sede:r.sede,turno:{dia:r.turno_dia,hora:r.turno_hora},mp:mp,ex:xe,canc:ca,reg:r.clase_regalo||0,pw:r.password,estado:r.estado||"activo"}}
function bPr(r){var s=r.sedes||[],se=s.length?s[0]:"Palermo";return{id:r.id,nombre:r.nombre,sede:se,sedes:s,horarios:r.horarios||[],pw:r.password,esEnc:r.encargada||false,sedeEnc:r.encargada?se:null}}
function gMS(a,mk){var p=mk.split("-").map(Number),tot=cIM(a.turno.dia,a.turno.hora,p[1],p[0]).length,i5=tot===5,ct=(a.canc||[]).filter(function(c){return c.mk===mk}),rt=(a.ex||[]).filter(function(e){return e.mk===mk}),csr=ct.filter(function(c){return c.noR}).length,ccr=ct.length-csr,pn=ccr-rt.length;if(pn<0)pn=0;var ce=CB-ccr+rt.length;if(i5&&ct.length===0)ce=5;return{tot:tot,i5:i5,cancT:ct.length,csr:csr,ccr:ccr,rec:rt.length,pn:pn,ce:ce}}
function gCupo(als,se,di,hr,fe){var ds=fe.toISOString(),f=0,rc=0;als.forEach(function(a){if(a.sede!==se)return;if(a.turno.dia===di&&a.turno.hora===hr){if(!(a.canc||[]).some(function(c){return c.iso===ds}))f++}(a.ex||[]).forEach(function(e){if(e.date===ds)rc++})});return{oc:f+rc,li:MXC-f-rc}}
function gAlSlot(als,se,di,hr,fe){var ds=fe.toISOString(),r=[];als.forEach(function(a){if(a.sede!==se)return;var mk=fe.getFullYear()+"-"+fe.getMonth();if(!(a.mp||{})[mk])return;if(a.turno.dia===di&&a.turno.hora===hr){if(!(a.canc||[]).some(function(c){return c.iso===ds}))r.push({alumno:a,tipo:"fijo"})}(a.ex||[]).forEach(function(e){if(e.date===ds&&!r.find(function(x){return x.alumno.id===a.id}))r.push({alumno:a,tipo:"recuperacion"})})});return r}
function cFijos(als,se,di,hr,fe){var ds=fe.toISOString(),mk=fe.getFullYear()+"-"+fe.getMonth(),c=0;als.forEach(function(a){if(a.sede!==se)return;if(!(a.mp||{})[mk])return;if(a.turno.dia===di&&a.turno.hora===hr){if(!(a.canc||[]).some(function(x){return x.iso===ds}))c++}});return c}
function useHash(){var _h=useState(window.location.hash||"#/alumna"),h=_h[0],sH=_h[1];useEffect(function(){function f(){sH(window.location.hash)}window.addEventListener("hashchange",f);return function(){window.removeEventListener("hashchange",f)}},[]);return h}
function Loading(){return(<div style={{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:cr,flexDirection:"column",gap:12}}><p style={{fontSize:28,fontFamily:"'Instrument Serif',serif",fontWeight:700,color:nv}}>EVES POTTERY</p><p style={{color:gw,fontSize:14,fontFamily:ft}}>Cargando datos...</p><div style={{width:40,height:40,border:"3px solid "+gb,borderTop:"3px solid "+cp,borderRadius:"50%",animation:"spin 1s linear infinite"}}/><style>{`@keyframes spin{to{transform:rotate(360deg)}}`}</style></div>)}
function AdmLogin(p){var _p=useState(""),pw=_p[0],sP=_p[1],_e=useState(""),er=_e[0],sE=_e[1];function go(){if(pw===APW){p.onLogin();sE("")}else sE("Contrase√±a incorrecta.")}var iS={width:"100%",padding:"12px 16px",borderRadius:10,border:"1px solid "+gb,fontSize:14,fontFamily:ft,background:wh,outline:"none",boxSizing:"border-box"};return(<div style={{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:24,background:cr}}><div style={{width:"100%",maxWidth:360}}><div style={{textAlign:"center",marginBottom:28}}><p style={{fontSize:28,fontFamily:"'Instrument Serif',serif",fontWeight:700,color:nv,margin:"0 0 4px"}}>EVES POTTERY</p><p style={{color:gw,fontSize:14,fontFamily:ft,margin:0}}>Panel de administraci√≥n</p></div><div style={{display:"flex",flexDirection:"column",gap:12}}><div><label style={{fontSize:12,fontWeight:600,color:nv,fontFamily:ft,marginBottom:4,display:"block"}}>Contrase√±a</label><input type="password" value={pw} onChange={function(e){sP(e.target.value)}} onKeyDown={function(e){if(e.key==="Enter")go()}} placeholder="Contrase√±a de admin" style={iS}/></div>{er?<p style={{color:"#991b1b",fontSize:13,margin:0,fontFamily:ft}}>{er}</p>:null}<button onClick={go} style={{padding:"12px",borderRadius:10,background:cp,color:wh,border:"none",cursor:"pointer",fontWeight:700,fontFamily:ft,fontSize:14,width:"100%"}}>Entrar</button></div></div></div>)}
function AdmChat(p){var als=p.als,rd=p.rd,prf=p.prf,lis=p.lis,ref=useRef(null);var wm="¬°Hola! Asistente Eves Pottery ‚ú¶\n\nComandos:\n‚Ä¢ Alta alumno: Nombre / Sede / d√≠a hora\n‚Ä¢ Baja: Nombre\n‚Ä¢ Pago recibido: Nombre (mes a√±o)\n‚Ä¢ Pagos mes a√±o: nombre1, nombre2...\n‚Ä¢ Consulta: Nombre\n‚Ä¢ Clase regalo: Nombre\n‚Ä¢ Alumnos [P|SI] hoy/martes/ma√±ana\n‚Ä¢ Ver alumnos [P|SI]\n‚Ä¢ Pagos pendientes [P|SI]\n‚Ä¢ Alta profe / Baja profe / Ver profes\n‚Ä¢ Notificaciones";
var _m=useState([{from:"bot",text:wm}]),ms=_m[0],sM=_m[1],_i=useState(""),inp=_i[0],sI=_i[1],_b=useState(false),by=_b[0],sB=_b[1];
useEffect(function(){if(ref.current)ref.current.scrollIntoView({behavior:"smooth"})},[ms]);
function fA(n){var l=n.toLowerCase().trim();return als.findIndex(function(a){return a.nombre.toLowerCase().includes(l)})}
function pSe(t){if(t.match(/\b(si|san\s*isidro)\b/i))return"San Isidro";if(t.match(/\bP\b/))return"Palermo";return null}
function fBS(l,s){return s?l.filter(function(a){return a.sede===s}):l}
async function resp(txt){var t=txt.toLowerCase().trim(),sf=pSe(t),sl=sf?" ("+sf+")":"";
if(t.startsWith("notif")){var nt=await db("admin_notifs","GET","?order=created_at.desc&limit=20");if(nt&&nt.length)return"‚ú¶ Notificaciones\n\n"+nt.map(function(n){return"‚Ä¢ ["+n.tipo+"] "+n.nombre+(n.sede?" ("+n.sede+")":"")}).join("\n");return"‚ú¶ Sin notificaciones pendientes ‚úì"}
if(t.includes("ver profe")||t==="profes"){if(!prf.length)return"No hay profes.";return"‚ú¶ Profesoras:\n\n"+prf.map(function(p){return"‚Ä¢ "+p.nombre+" ‚Äî "+p.sede+(p.esEnc?" (Enc)":"")+"\n  "+p.horarios.map(function(h){return h.replace("-"," ")}).join(", ")}).join("\n")}
if(t.startsWith("alta profe")){var rw=txt.replace(/alta\s*profe\s*:?\s*/i,"").trim(),pt=rw.split("/").map(function(s){return s.trim()});if(pt.length<3)return"Formato: Alta profe: Nombre / Sede / d√≠a hora, d√≠a hora";var nm=pt[0],se=pt[1].toLowerCase().includes("palermo")?"Palermo":"San Isidro";var df={"lunes":"lunes","martes":"martes","miercoles":"mi√©rcoles","mi√©rcoles":"mi√©rcoles","jueves":"jueves","viernes":"viernes","sabado":"s√°bado","s√°bado":"s√°bado"};var hr=pt.slice(2).join("/").split(",").map(function(h){var m=h.trim().toLowerCase().match(/([a-z√°√©√≠√≥√∫√±√º]+)\s+(\d{1,2}:\d{2})/);if(!m)return null;var d=df[m[1]];return d?d+"-"+m[2]:null}).filter(Boolean);if(!hr.length)return"No entend√≠ los horarios.";var pw=gPw("prof");var rs=await db("profesoras","POST","",{nombre:nm,sedes:[se],horarios:hr,password:pw,encargada:false});if(rs){await rd();return"‚úì "+nm+" ‚Äî "+se+"\nüîë "+pw}return"‚úó Error"}
if(t.startsWith("baja profe")){var n=txt.replace(/baja\s*profe\s*:?\s*/i,"").trim(),ix=prf.findIndex(function(p){return p.nombre.toLowerCase().includes(n.toLowerCase())});if(ix===-1)return"‚úó No encontr√©.";await db("profesoras","DELETE","?id=eq."+prf[ix].id);await rd();return"‚úì "+prf[ix].nombre+" dada de baja."}
if(t.includes("pagos pendiente")){var nw=new Date(),mk=nw.getFullYear()+"-"+nw.getMonth(),pn=fBS(als,sf).filter(function(a){return!(a.mp||{})[mk]});if(!pn.length)return"‚úì Todos al d√≠a"+sl;return"‚ú¶ Pendientes "+MN[nw.getMonth()]+sl+":\n\n"+pn.map(function(a){return"‚Ä¢ "+a.nombre+" ‚Äî "+a.sede+" ‚Äî "+a.turno.dia+" "+a.turno.hora}).join("\n")+"\n\nTotal: "+pn.length}
var mm=txt.match(/pagos\s+([\w√©√°√≠√≥√∫]+)\s+(\d{4})\s*:\s*(.+)/i);if(mm){var ps=pMes(mm[1]+" "+mm[2]);if(!ps)return"No entend√≠ el mes.";var ns=mm[3].split(",").map(function(s){return s.trim()}).filter(Boolean),ok=[],nf=[];for(var i=0;i<ns.length;i++){var ix2=als.findIndex(function(a){return a.nombre.toLowerCase().includes(ns[i].toLowerCase())});if(ix2===-1){nf.push(ns[i]);continue}await db("meses_pagados","POST","",{alumno_id:als[ix2].id,mes_key:ps.key});await db("historial","POST","",{alumno_id:als[ix2].id,accion:"üí≥ "+MN[ps.month]+" "+ps.year});ok.push(als[ix2].nombre)}await rd();var r="‚ú¶ Pago masivo "+MN[ps.month]+":\n\n";if(ok.length)r+="‚úì "+ok.join(", ")+"\n";if(nf.length)r+="‚úó No encontrados: "+nf.join(", ");return r}
if(t.includes("ver alumno")||t==="alumnos"||t==="lista"){var fl=fBS(als,sf);if(!fl.length)return"No hay alumnos"+sl;return"‚ú¶ Alumnos"+sl+":\n\n"+fl.map(function(a){var m=Object.keys(a.mp||{}).map(function(k){return MN[parseInt(k.split("-")[1])]}).join(", ")||"‚Äî";return"‚Ä¢ "+a.nombre+" ‚Äî "+a.sede+" ‚Äî "+a.turno.dia+" "+a.turno.hora+" ‚Äî Pag√≥: "+m}).join("\n")}
if(t.startsWith("baja")&&!t.startsWith("baja profe")){var n3=txt.replace(/baja\s*:?\s*/i,"").trim();if(!n3)return"Formato: Baja: Nombre";var i3=fA(n3);if(i3===-1)return"‚úó No encontr√©.";await db("alumnos","PATCH","?id=eq."+als[i3].id,{estado:"baja"});await db("historial","POST","",{alumno_id:als[i3].id,accion:"Baja"});await rd();return"‚úì "+als[i3].nombre+" dado de baja."}
if(t.startsWith("consulta")){var n4=txt.replace(/consulta\s*:?\s*/i,"").trim();if(!n4)return"Formato: Consulta: Nombre";var i4=fA(n4);if(i4===-1)return"‚úó No encontr√©.";var a4=als[i4],m4=Object.keys(a4.mp||{});var r4="‚ú¶ "+a4.nombre+"\nüìç "+a4.sede+" ¬∑ "+a4.turno.dia+" "+a4.turno.hora+"\nüí≥ Pag√≥: "+(m4.length?m4.map(function(k){return MN[parseInt(k.split("-")[1])]}).join(", "):"‚Äî")+"\nüéÅ Regalo: "+(a4.reg||0);m4.forEach(function(mk){var s=gMS(a4,mk),p2=mk.split("-").map(Number);r4+="\n\nüìÖ "+MN[p2[1]]+":\n  Clases: "+s.tot+(s.i5?" (5ta)":"")+"\n  Cancel: "+s.cancT+"\n  Recup: "+s.rec+"\n  Pend: "+s.pn+"\n  Efectivas: "+s.ce+"/"+CB});return r4}
if(t.includes("clase regalo")){var n5=txt.replace(/clase\s*(de\s*)?regalo\s*:?\s*/i,"").trim();if(!n5)return"Formato: Clase regalo: Nombre";var i5=fA(n5);if(i5===-1)return"‚úó No encontr√©.";await db("alumnos","PATCH","?id=eq."+als[i5].id,{clase_regalo:(als[i5].reg||0)+1});await db("historial","POST","",{alumno_id:als[i5].id,accion:"üéÅ Regalo"});await rd();return"‚úì Regalo para "+als[i5].nombre}
var hs=txt.includes("/"),la=t.includes("alta")||(hs&&(t.includes("palermo")||t.includes("isidro")));
if(la&&!t.startsWith("alta profe")){var pt2=txt.split("/").map(function(s){return s.trim()});if(pt2.length<3)return"Formato: Nombre / Sede / d√≠a hora";var nm2=pt2[0].replace(/alta\s*(de\s*)?alumno\s*:?\s*/i,"").trim(),sp=pt2[pt2.length-2],tp=pt2[pt2.length-1];var se2=sp.toLowerCase().includes("palermo")?"Palermo":"San Isidro";var tm=tp.toLowerCase().match(/(lunes|martes|mi√©rcoles|jueves|viernes|s√°bado)\s+(\d{1,2}:\d{2})/);if(!tm)return"No entend√≠ el turno.";var sk=tm[1]+"-"+tm[2];if(SC[se2].indexOf(sk)===-1)return"‚úó No existe ese horario en "+se2;var pw2=gPw("eves");var rs2=await db("alumnos","POST","",{nombre:nm2,tel:"",email:"",sede:se2,turno_dia:tm[1],turno_hora:tm[2],password:pw2,clase_regalo:0,estado:"activo",pend_arrastre:0});if(rs2){await rd();return"‚úì Alta: "+nm2+" ‚Äî "+se2+" "+tm[1]+" "+tm[2]+"\nüîë "+pw2}return"‚úó Error"}
if(t.includes("pago")){var mt=txt.match(/pago\s*(recibido|confirmado|ok)\s*:?\s*(.+)/i);if(!mt)return"Formato: Pago recibido: Nombre (mes a√±o)";var rs3=mt[2].trim(),mM=rs3.match(/\(([^)]+)\)/);if(!mM)return"Inclu√≠ el mes entre par√©ntesis.";var ps2=pMes(mM[1]);if(!ps2)return"No entend√≠ el mes.";var n6=rs3.replace(/\([^)]+\)/,"").trim(),i6=fA(n6);if(i6===-1)return"‚úó No encontr√©.";var a6=als[i6];await db("meses_pagados","POST","",{alumno_id:a6.id,mes_key:ps2.key});await db("historial","POST","",{alumno_id:a6.id,accion:"üí≥ "+MN[ps2.month]+" "+ps2.year});await rd();return"‚úì "+a6.nombre+" ‚Äî "+MN[ps2.month]+" "+ps2.year}
return"No entend√≠. Prob√°: ver alumnos, alta, baja, pago recibido, pagos masivo, consulta, clase regalo, pagos pendientes, alta profe, ver profes, notificaciones"}
async function send(){if(!inp.trim()||by)return;var t=inp;sI("");sM(function(p){return p.concat({from:"user",text:t})});sB(true);var r=await resp(t);sM(function(p){return p.concat({from:"bot",text:r})});sB(false)}
return(<div style={{display:"flex",flexDirection:"column",height:"100%",background:cr}}><div style={{flex:1,overflowY:"auto",padding:16}}>{ms.map(function(m,i){var b=m.from==="bot";return(<div key={i} style={{display:"flex",justifyContent:b?"flex-start":"flex-end",marginBottom:10}}><div style={{maxWidth:"85%",padding:"11px 15px",borderRadius:b?"4px 14px 14px 14px":"14px 4px 14px 14px",background:b?wh:nv,color:b?nv:cr,fontSize:14,lineHeight:1.55,whiteSpace:"pre-wrap",fontFamily:ft,border:b?"1px solid "+gb:"none"}}>{m.text}</div></div>)})}{by?<div style={{display:"flex",justifyContent:"flex-start",marginBottom:10}}><div style={{padding:"11px 15px",borderRadius:"4px 14px 14px 14px",background:wh,border:"1px solid "+gb,fontSize:14,fontFamily:ft,color:gw}}>Procesando...</div></div>:null}<div ref={ref}/></div><div style={{padding:12,borderTop:"1px solid "+gb,display:"flex",gap:8,background:wh}}><input value={inp} onChange={function(e){sI(e.target.value)}} onKeyDown={function(e){if(e.key==="Enter")send()}} placeholder="Escrib√≠ un comando..." style={{flex:1,padding:"11px 16px",borderRadius:10,border:"1px solid "+gb,fontSize:14,outline:"none",fontFamily:ft,background:cr}}/><button onClick={send} disabled={by} style={{padding:"11px 22px",borderRadius:10,background:by?gw:cp,color:wh,border:"none",cursor:by?"default":"pointer",fontWeight:700,fontFamily:ft}}>Enviar</button></div></div>)}
function GLogin(p){var tb=p.table,oL=p.onLogin,st=p.subtitle,sP=p.skipPw,rD=p.rd;var _s=useState("login"),sp=_s[0],sS=_s[1],_n=useState(""),nm=_n[0],sN=_n[1],_p=useState(""),pw=_p[0],sPw=_p[1],_p2=useState(""),pw2=_p2[0],sP2=_p2[1],_e=useState(""),er=_e[0],sE=_e[1],_f=useState(null),fd=_f[0],sF=_f[1],_b=useState(false),by=_b[0],sB=_b[1];
async function go(){sE("");sB(true);var q="?nombre=ilike."+encodeURIComponent(nm.trim());if(tb==="alumnos"&&!sP){var rw=await db(tb,"GET","?nombre=ilike."+encodeURIComponent(nm.trim()));sB(false);if(!rw||!rw.length){sE("No encontramos ese nombre.");return}var it=rw[0];if(it.estado==="baja"){sE("Tu cuenta fue dada de baja. Contact√° al taller.");return}if(it.estado==="suspendida"){sE("Tu cuenta est√° suspendida. Contact√° al taller.");return}if(!it.password){sF(it);sS("setup");sPw("");sP2("");return}if(it.password!==pw){sE("Contrase√±a incorrecta.");return}oL(it);return}if(tb==="profesoras"&&!sP){var rw2=await db(tb,"GET",q);sB(false);if(!rw2||!rw2.length){sE("No encontramos ese nombre.");return}var it2=rw2[0];if(!it2.password){sF(it2);sS("setup");sPw("");sP2("");return}if(it2.password!==pw){sE("Contrase√±a incorrecta.");return}oL(it2);return}var rw3=await db(tb,"GET",q+(tb==="alumnos"?"&estado=eq.activo":""));sB(false);if(!rw3||!rw3.length){sE("No encontramos ese nombre.");return}oL(rw3[0])}
async function doS(){sE("");if(pw.length<4){sE("M√≠nimo 4 caracteres.");return}if(pw!==pw2){sE("No coinciden.");return}sB(true);await db(tb,"PATCH","?id=eq."+fd.id,{password:pw});sB(false);if(rD)await rD();oL(Object.assign({},fd,{password:pw}))}
var iS={width:"100%",padding:"12px 16px",borderRadius:10,border:"1px solid "+gb,fontSize:14,fontFamily:ft,background:wh,outline:"none",boxSizing:"border-box"},lS={fontSize:12,fontWeight:600,color:nv,fontFamily:ft,marginBottom:4,display:"block"};
return(<div style={{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:24,background:cr}}><div style={{width:"100%",maxWidth:360}}><div style={{textAlign:"center",marginBottom:28}}><p style={{fontSize:28,fontFamily:"'Instrument Serif',serif",fontWeight:700,color:nv,margin:"0 0 4px"}}>EVES POTTERY</p><p style={{color:gw,fontSize:14,fontFamily:ft,margin:0}}>{st||"Acced√© a tus clases"}</p></div>{sp==="login"?(<div style={{display:"flex",flexDirection:"column",gap:12}}><div><label style={lS}>Nombre completo</label><input value={nm} onChange={function(e){sN(e.target.value)}} onKeyDown={function(e){if(e.key==="Enter")go()}} placeholder="Tu nombre" style={iS}/></div>{!sP?<div><label style={lS}>Contrase√±a</label><input type="password" value={pw} onChange={function(e){sPw(e.target.value)}} onKeyDown={function(e){if(e.key==="Enter")go()}} placeholder="Tu contrase√±a" style={iS}/></div>:null}{er?<p style={{color:"#991b1b",fontSize:13,margin:0,fontFamily:ft}}>{er}</p>:null}<button onClick={go} disabled={by} style={{padding:"12px",borderRadius:10,background:cp,color:wh,border:"none",cursor:"pointer",fontWeight:700,fontFamily:ft,fontSize:14,width:"100%"}}>{by?"Verificando...":"Entrar"}</button>{!sP?<p style={{color:gw,fontSize:12,fontFamily:ft,margin:0,textAlign:"center"}}>Primera vez? Ingres√° tu nombre y te pedir√° crear contrase√±a.</p>:null}</div>):(<div style={{display:"flex",flexDirection:"column",gap:12}}><div style={{background:"#f0f5e8",borderRadius:10,padding:14,border:"1px solid #b5c48a"}}><p style={{margin:0,color:"#5a6a2a",fontSize:14,fontFamily:ft}}>{"¬°Hola "+fd.nombre.split(" ")[0]+"! Cre√° tu contrase√±a."}</p></div><div><label style={lS}>Contrase√±a</label><input type="password" value={pw} onChange={function(e){sPw(e.target.value)}} placeholder="M√≠nimo 4 caracteres" style={iS}/></div><div><label style={lS}>Repet√≠</label><input type="password" value={pw2} onChange={function(e){sP2(e.target.value)}} onKeyDown={function(e){if(e.key==="Enter")doS()}} placeholder="Repet√≠" style={iS}/></div>{er?<p style={{color:"#991b1b",fontSize:13,margin:0,fontFamily:ft}}>{er}</p>:null}<button onClick={doS} disabled={by} style={{padding:"12px",borderRadius:10,background:cp,color:wh,border:"none",cursor:"pointer",fontWeight:700,fontFamily:ft,fontSize:14,width:"100%"}}>{by?"Guardando...":"Crear y entrar"}</button><button onClick={function(){sS("login");sPw("");sP2("");sE("")}} style={{padding:"12px",borderRadius:10,background:wh,color:nv,border:"1px solid "+gb,cursor:"pointer",fontWeight:600,fontFamily:ft,fontSize:14,width:"100%"}}>{"‚Üê Volver"}</button></div>)}</div></div>)}
function PrfV(p){var pr=p.profe,als=p.als,rd=p.rd,lis=p.lis,_t=useState("clases"),tb=_t[0],sT=_t[1];return(<div style={{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"}}><div style={{padding:"10px 18px",background:wh,borderBottom:"1px solid "+gb}}><p style={{margin:0,fontWeight:700,color:nv,fontFamily:ft,fontSize:15}}>{pr.nombre}{pr.esEnc?" (Enc)":""}</p><p style={{margin:0,color:gw,fontSize:12,fontFamily:ft}}>{pr.sede}</p></div><div style={{display:"flex",borderBottom:"1px solid "+gb}}><button onClick={function(){sT("clases")}} style={{flex:1,padding:"11px",border:"none",cursor:"pointer",fontSize:14,fontWeight:600,fontFamily:ft,background:tb==="clases"?wh:cr,color:tb==="clases"?nv:gw,borderBottom:tb==="clases"?"2px solid "+cp:"2px solid transparent"}}>üìÖ Mis clases</button><button onClick={function(){sT("lista")}} style={{flex:1,padding:"11px",border:"none",cursor:"pointer",fontSize:14,fontWeight:600,fontFamily:ft,background:tb==="lista"?wh:cr,color:tb==="lista"?nv:gw,borderBottom:tb==="lista"?"2px solid "+cp:"2px solid transparent"}}>‚úã Tomar lista</button>{pr.esEnc?<button onClick={function(){sT("sede")}} style={{flex:1,padding:"11px",border:"none",cursor:"pointer",fontSize:14,fontWeight:600,fontFamily:ft,background:tb==="sede"?wh:cr,color:tb==="sede"?nv:gw,borderBottom:tb==="sede"?"2px solid "+cp:"2px solid transparent"}}>üè† Sede</button>:null}</div><div style={{flex:1,overflow:"auto",background:wh}}>{tb==="clases"?<PrfCl pr={pr} als={als}/>:null}{tb==="lista"?<PrfLi pr={pr} als={als} rd={rd} lis={lis}/>:null}{tb==="sede"&&pr.esEnc?<EncV pr={pr} als={als}/>:null}</div></div>)}
function PrfCl(p){var pr=p.pr,als=p.als,nw=new Date(),lm=new Date(nw);lm.setDate(lm.getDate()+7);var cl=[];pr.horarios.forEach(function(h){var pt=h.split("-"),di=pt[0],hr=pt[1];for(var dd=new Date(nw);dd<=lm;dd=new Date(dd.getTime()+864e5)){var dw=dd.getDay(),dx=dw===0?6:dw-1;if(DY[dx]===di){var dt=new Date(dd),tp=hr.split(":");dt.setHours(parseInt(tp[0]),parseInt(tp[1]),0,0);if(dt>nw){var ex=gAlSlot(als,pr.sede,di,hr,dt),fj=cFijos(als,pr.sede,di,hr,dt);cl.push({date:dt,al:ex.length,fj:fj})}}}});cl.sort(function(a,b){return a.date-b.date});var si=pr.sede==="San Isidro";return(<div style={{padding:20}}><h3 style={{margin:"0 0 14px",color:nv,fontFamily:ft,fontWeight:700,fontSize:18}}>Pr√≥ximas clases (7 d√≠as)</h3>{cl.length===0?<p style={{color:gw,fontFamily:ft,fontSize:14}}>No ten√©s clases pr√≥ximas.</p>:cl.map(function(c,i){var mt,mb,mc,mg;if(si){mt="‚òÄÔ∏è ¬°Que disfrutes mucho de la clase! No te olvides de tomar lista. ¬°Gracias! üòä";mb="#f0f5e8";mc="#b5c48a";mg="#5a6a2a"}else if(c.fj===0){mt="üîß No hay alumnos, recuerda hacer producci√≥n. ¬°Que lo disfrutes!";mb="#f5f0fa";mc="#c4b5d4";mg="#6b5080"}else if(c.al<4){mt="‚ö†Ô∏è Menos de 4 alumnos, record√° producci√≥n o taller. ¬°No te olvides de tomar lista! üòä";mb="#fdf6ec";mc="#e8d4b0";mg="#92651e"}else{mt="‚òÄÔ∏è ¬°Que disfrutes mucho de la clase! No te olvides de tomar lista. ¬°Gracias! üòä";mb="#f0f5e8";mc="#b5c48a";mg="#5a6a2a"}return(<div key={i} style={{marginBottom:12,borderRadius:12,border:"1px solid "+gb,overflow:"hidden"}}><div style={{padding:"12px 16px",display:"flex",justifyContent:"space-between",alignItems:"center",background:"#f8f6f2"}}><span style={{fontWeight:700,color:nv,fontFamily:ft,fontSize:15}}>{fD(c.date)}</span><span style={{fontSize:13,color:c.fj===0?gw:cp,fontFamily:ft,fontWeight:600}}>{c.al+" alumno"+(c.al!==1?"s":"")}</span></div><div style={{padding:"10px 16px",background:mb,borderTop:"1px solid "+mc}}><p style={{margin:0,fontSize:13,fontFamily:ft,color:mg,lineHeight:1.5}}>{mt}</p></div></div>)})}</div>)}
function PrfLi(p){var pr=p.pr,als=p.als,rd=p.rd,lis=p.lis,_s=useState(null),sl=_s[0],sS=_s[1],_mk=useState({}),mk=_mk[0],sMk=_mk[1],_ex=useState([]),ex=_ex[0],sEx=_ex[1],_sr=useState(""),sr=_sr[0],sSr=_sr[1],_d=useState(false),dn=_d[0],sD=_d[1],_mg=useState(""),mg=_mg[0],sMg=_mg[1],_b=useState(false),by=_b[0],sB=_b[1];var nw=new Date(),lm=new Date(nw);lm.setDate(lm.getDate()+7);var cl=[];pr.horarios.forEach(function(h){var pt=h.split("-"),di=pt[0],hr=pt[1];for(var dd=new Date(nw);dd<=lm;dd=new Date(dd.getTime()+864e5)){var dw=dd.getDay(),dx=dw===0?6:dw-1;if(DY[dx]===di){var dt=new Date(dd),tp=hr.split(":");dt.setHours(parseInt(tp[0]),parseInt(tp[1]),0,0);var iso=dt.toISOString(),yt=lis.some(function(l){return l.profe===pr.nombre&&l.fecha_iso===iso});if(!yt){var exp=gAlSlot(als,pr.sede,di,hr,dt);cl.push({date:dt,dia:di,hora:hr,als:exp,iso:iso})}}}});cl.sort(function(a,b){return a.date-b.date});
function selC(c){sS(c);sMk({});sEx([]);sD(false);sMg("");sSr("")}
function tM(id,v){sMk(function(p){var o=Object.assign({},p);o[id]=v;return o})}
function aEx(a){if(ex.find(function(e){return e.id===a.id}))return;sEx(function(p){return p.concat(a)});tM(a.id,true);sSr("")}
function cSb(){if(!sl)return false;var ai=sl.als.map(function(a){return a.alumno.id}).concat(ex.map(function(e){return e.id}));return ai.every(function(id){return mk[id]===true||mk[id]===false})}
async function sub(){if(!cSb()||by)return;sB(true);var fa=[],ce=[],pr2=[];for(var i=0;i<sl.als.length;i++){var a=sl.als[i];if(mk[a.alumno.id]===false){fa.push(a.alumno);var m=sl.date.getFullYear()+"-"+sl.date.getMonth();await db("cancelaciones","POST","",{alumno_id:a.alumno.id,fecha_iso:sl.iso,mes_key:m,sin_recuperacion:true,sin_aviso:true,is_extra:a.tipo==="recuperacion"});await db("historial","POST","",{alumno_id:a.alumno.id,accion:"‚õî Falta "+fDS(sl.date)})}else pr2.push(a.alumno)}for(var j=0;j<ex.length;j++){if(mk[ex[j].id]===true){ce.push(ex[j]);var m2=sl.date.getFullYear()+"-"+sl.date.getMonth();await db("clases_extra","POST","",{alumno_id:ex[j].id,fecha_iso:sl.iso,mes_key:m2,tipo:"extra"});await db("historial","POST","",{alumno_id:ex[j].id,accion:"üìå Extra "+fDS(sl.date)})}}await db("listas","POST","",{profe:pr.nombre,sede:pr.sede,dia:sl.dia,hora:sl.hora,fecha_iso:sl.iso});await rd();sB(false);var r="‚úì Lista enviada\n\nPresentes: "+pr2.length+(ce.length?" + "+ce.length+" extra":"")+"\n";if(fa.length)r+="Faltas: "+fa.map(function(a){return a.nombre}).join(", ");sMg(r);sD(true)}
var bS={padding:"12px 18px",borderRadius:10,cursor:"pointer",fontSize:14,fontWeight:600,width:"100%",fontFamily:ft,background:wh,color:nv,border:"1px solid "+gb,textAlign:"left"};
if(dn)return(<div style={{padding:20}}><div style={{background:"#f0f5e8",borderRadius:12,padding:20,border:"1px solid #b5c48a",whiteSpace:"pre-wrap",fontSize:14,fontFamily:ft,color:"#5a6a2a",lineHeight:1.6}}>{mg}</div><button onClick={function(){sS(null);sD(false)}} style={Object.assign({},bS,{marginTop:12})}>‚Üê Volver</button></div>);
if(!sl)return(<div style={{padding:20}}><h3 style={{margin:"0 0 14px",color:nv,fontFamily:ft,fontWeight:700,fontSize:18}}>Tomar lista</h3>{cl.length===0?<p style={{color:gw,fontFamily:ft,fontSize:14}}>No hay clases pendientes.</p>:cl.map(function(c,i){return(<button key={i} onClick={function(){selC(c)}} style={Object.assign({},bS,{marginBottom:8})}>{fD(c.date)+" ‚Äî "+c.als.length+" alumno"+(c.als.length!==1?"s":"")}</button>)})}</div>);
var ai=sl.als.map(function(a){return a.alumno.id}).concat(ex.map(function(e){return e.id})),am=ai.every(function(id){return mk[id]===true||mk[id]===false});var sR=sr.length>=2?als.filter(function(a){return a.nombre.toLowerCase().includes(sr.toLowerCase())&&a.sede===pr.sede&&!sl.als.find(function(s){return s.alumno.id===a.id})&&!ex.find(function(e){return e.id===a.id})}):[];
return(<div style={{padding:20}}><h3 style={{margin:"0 0 4px",color:nv,fontFamily:ft,fontWeight:700,fontSize:16}}>{fD(sl.date)}</h3><p style={{margin:"0 0 16px",color:gw,fontSize:13,fontFamily:ft}}>{sl.als.length+" esperado"+(sl.als.length!==1?"s":"")}</p>{sl.als.map(function(a){var id=a.alumno.id,v=mk[id];return(<div key={id} style={{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 14px",marginBottom:6,borderRadius:10,border:"1px solid "+gb,background:v===true?"#f0f5e8":v===false?"#fef2f2":wh}}><span style={{fontFamily:ft,fontSize:14,color:nv,fontWeight:500}}>{a.alumno.nombre}{a.tipo==="recuperacion"?<span style={{color:gw,fontSize:12}}> (recup)</span>:null}</span><div style={{display:"flex",gap:6}}><button onClick={function(){tM(id,true)}} style={{width:36,height:36,borderRadius:8,border:v===true?"2px solid #5a6a2a":"1px solid "+gb,background:v===true?"#5a6a2a":wh,color:v===true?wh:nv,cursor:"pointer",fontSize:16,fontWeight:700}}>‚úì</button><button onClick={function(){tM(id,false)}} style={{width:36,height:36,borderRadius:8,border:v===false?"2px solid #991b1b":"1px solid "+gb,background:v===false?"#991b1b":wh,color:v===false?wh:nv,cursor:"pointer",fontSize:16,fontWeight:700}}>‚úó</button></div></div>)})}{ex.map(function(a){var id=a.id,v=mk[id];return(<div key={id} style={{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 14px",marginBottom:6,borderRadius:10,border:"1px solid #e8d4b0",background:"#fdf6ec"}}><span style={{fontFamily:ft,fontSize:14,color:cp,fontWeight:500}}>{a.nombre} <span style={{fontSize:12}}>(extra)</span></span><div style={{display:"flex",gap:6}}><button onClick={function(){tM(id,true)}} style={{width:36,height:36,borderRadius:8,border:v===true?"2px solid #5a6a2a":"1px solid "+gb,background:v===true?"#5a6a2a":wh,color:v===true?wh:nv,cursor:"pointer",fontSize:16,fontWeight:700}}>‚úì</button><button onClick={function(){tM(id,false)}} style={{width:36,height:36,borderRadius:8,border:v===false?"2px solid #991b1b":"1px solid "+gb,background:v===false?"#991b1b":wh,color:v===false?wh:nv,cursor:"pointer",fontSize:16,fontWeight:700}}>‚úó</button></div></div>)})}<div style={{marginTop:12,marginBottom:12}}><input value={sr} onChange={function(e){sSr(e.target.value)}} placeholder="Buscar extra..." style={{width:"100%",padding:"10px 14px",borderRadius:10,border:"1px solid "+gb,fontSize:14,fontFamily:ft,outline:"none",background:cr,boxSizing:"border-box"}}/>{sR.map(function(a){return(<button key={a.id} onClick={function(){aEx(a)}} style={{display:"block",width:"100%",textAlign:"left",padding:"8px 14px",marginTop:4,borderRadius:8,border:"1px solid #e8d4b0",background:"#fdf6ec",cursor:"pointer",fontFamily:ft,fontSize:13,color:cp}}>{"+ "+a.nombre}</button>)})}</div><div style={{display:"flex",gap:8}}><button onClick={function(){sS(null);sMk({});sEx([])}} style={Object.assign({},bS,{flex:1})}>‚Üê Volver</button><button disabled={!am||by} onClick={sub} style={{flex:1,padding:"12px 18px",borderRadius:10,cursor:am&&!by?"pointer":"default",fontSize:14,fontWeight:700,fontFamily:ft,background:am&&!by?cp:cr,color:am&&!by?wh:gw,border:"none"}}>{by?"Enviando...":"Enviar lista"}</button></div></div>)}
function EncV(p){var pr=p.pr,als=p.als,se=pr.sedeEnc,nw=new Date(),yr=nw.getFullYear(),mo=nw.getMonth(),sc=SC[se]||[],cl=[];sc.forEach(function(h){var pt=h.split("-"),di=pt[0],hr=pt[1];cIM(di,hr,mo,yr).forEach(function(dt){var c=gCupo(als,se,di,hr,dt);cl.push({date:dt,al:c.oc,past:dt<nw})})});cl.sort(function(a,b){return a.date-b.date});return(<div style={{padding:20}}><h3 style={{margin:"0 0 4px",color:nv,fontFamily:ft,fontWeight:700,fontSize:18}}>Sede: {se}</h3><p style={{margin:"0 0 14px",color:gw,fontSize:13,fontFamily:ft}}>{MN[mo]+" "+yr}</p>{cl.map(function(c,i){return(<div key={i} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 14px",marginBottom:6,borderRadius:10,border:"1px solid "+gb,background:c.past?"#f5f5f0":wh,opacity:c.past?0.5:1}}><span style={{fontFamily:ft,fontSize:14,color:nv,fontWeight:500}}>{fDS(c.date)}</span><span style={{fontFamily:ft,fontSize:13,color:cp,fontWeight:600}}>{c.al+" alumno"+(c.al!==1?"s":"")}</span></div>)})}</div>)}
function AlCal(p){var a=p.al,pm=Object.keys(a.mp||{});if(!pm.length)return(<div style={{padding:36,textAlign:"center"}}><p style={{fontSize:44,opacity:0.5}}>üîí</p><h3 style={{color:nv,fontFamily:ft}}>Calendario no disponible</h3><p style={{color:gw,fontSize:14,fontFamily:ft}}>No ten√©s meses pagados.</p></div>);var al=[];pm.forEach(function(mk){var pt=mk.split("-").map(Number),mc=cIM(a.turno.dia,a.turno.hora,pt[1],pt[0]),cm=(a.canc||[]).filter(function(c){return c.mk===mk});mc.forEach(function(d){if(!cm.some(function(c){return c.iso===d.toISOString()}))al.push({date:d,extra:false})})});(a.ex||[]).forEach(function(e){al.push({date:new Date(e.date),extra:true})});al.sort(function(a,b){return a.date-b.date});var sb=pm.map(function(mk){var s=gMS(a,mk),pt=mk.split("-").map(Number);return{label:MN[pt[1]]+" "+pt[0],s:s,mk:mk}});return(<div style={{padding:20}}><h3 style={{margin:"0 0 2px",color:nv,fontFamily:ft,fontWeight:700,fontSize:18}}>Tus clases</h3><p style={{margin:"0 0 14px",color:gw,fontSize:13,fontFamily:ft}}>{a.turno.dia+" "+a.turno.hora+" ¬∑ "+a.sede}</p>{sb.map(function(x){return(<div key={x.mk} style={{background:"#f8f6f2",borderRadius:10,padding:"12px 14px",marginBottom:14,border:"1px solid "+gb}}><div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4}}><span style={{fontWeight:700,color:nv,fontFamily:ft,fontSize:14}}>{x.label}</span><span style={{fontSize:12,color:cp,fontFamily:ft,fontWeight:600}}>{x.s.ce+"/"+CB+" clases"}</span></div>{x.s.pn>0?<div style={{background:"#fdf6ec",borderRadius:8,padding:"6px 10px",fontSize:13,color:cp,fontFamily:ft,border:"1px solid #e8d4b0"}}>{"üîÑ "+x.s.pn+" pendiente(s)"}</div>:null}{x.s.i5&&x.s.cancT===0?<div style={{fontSize:12,color:ol,fontFamily:ft,marginTop:4}}>‚ú¶ 5ta clase regalo activa</div>:null}</div>)})}{a.reg>0?<div style={{background:"#fdf6ec",border:"1px solid #e8d4b0",borderRadius:10,padding:"10px 14px",marginBottom:14,fontSize:13,color:cp,fontFamily:ft}}>{"üéÅ "+a.reg+" clase(s) de regalo"}</div>:null}<div style={{display:"flex",flexDirection:"column",gap:8}}>{al.map(function(c,i){var h=hU(c.date),ps=h<0;return(<div key={i} style={{padding:"14px 16px",borderRadius:10,background:ps?cr:wh,border:"1px solid "+(ps?gb:gd),opacity:ps?0.45:1}}><div style={{display:"flex",justifyContent:"space-between",alignItems:"center"}}><span style={{fontWeight:600,color:nv,fontFamily:ft,fontSize:14}}>{fD(c.date)}</span>{c.extra?<span style={{fontSize:11,background:ol,color:wh,padding:"2px 8px",borderRadius:8,fontFamily:ft}}>recuperaci√≥n</span>:null}</div>{!ps&&h<24?<div style={{fontSize:11,color:cp,marginTop:5,fontFamily:ft}}>‚ö† Menos de 24h</div>:null}</div>)})}</div></div>)}
function MCal(p){var oS=p.onSelect,sD=p.sel,aD=p.avail,_m=useState(function(){var n=new Date();return{m:n.getMonth(),y:n.getFullYear()}}),cm=_m[0],sC=_m[1];var f=new Date(cm.y,cm.m,1),sd=f.getDay()===0?6:f.getDay()-1,dm=new Date(cm.y,cm.m+1,0).getDate(),cl=[];for(var i=0;i<sd;i++)cl.push(null);for(var d=1;d<=dm;d++)cl.push(d);var dl=["L","M","X","J","V","S","D"],as={};(aD||[]).forEach(function(dt){as[dt.getFullYear()+"-"+dt.getMonth()+"-"+dt.getDate()]=true});function iS(d){return sD&&d&&sD.getDate()===d&&sD.getMonth()===cm.m&&sD.getFullYear()===cm.y}function hS(d){return d&&as[cm.y+"-"+cm.m+"-"+d]}return(<div style={{background:wh,borderRadius:12,border:"1px solid "+gb,padding:14,marginBottom:12}}><div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10}}><button onClick={function(){sC(function(p){return p.m===0?{m:11,y:p.y-1}:{m:p.m-1,y:p.y}})}} style={{background:"none",border:"none",cursor:"pointer",fontSize:18,color:nv,padding:"4px 8px"}}>‚Äπ</button><span style={{fontWeight:700,color:nv,fontFamily:ft,fontSize:15}}>{MN[cm.m]+" "+cm.y}</span><button onClick={function(){sC(function(p){return p.m===11?{m:0,y:p.y+1}:{m:p.m+1,y:p.y}})}} style={{background:"none",border:"none",cursor:"pointer",fontSize:18,color:nv,padding:"4px 8px"}}>‚Ä∫</button></div><div style={{display:"grid",gridTemplateColumns:"repeat(7,1fr)",gap:2,textAlign:"center"}}>{dl.map(function(l){return<div key={l} style={{fontSize:11,color:gw,fontFamily:ft,fontWeight:600,padding:4}}>{l}</div>})}{cl.map(function(d,i){var s=iS(d),av=hS(d),td=new Date(),it=d&&td.getDate()===d&&td.getMonth()===cm.m&&td.getFullYear()===cm.y;return(<div key={i} onClick={function(){if(d)oS(new Date(cm.y,cm.m,d))}} style={{padding:"8px 2px",borderRadius:8,cursor:d?"pointer":"default",background:s?cp:av?"#f0f5e8":"transparent",color:s?wh:av?"#5a6a2a":d?nv:"transparent",fontWeight:s||it?700:400,fontSize:13,fontFamily:ft,border:it&&!s?"1px solid "+cp:"1px solid transparent"}}>{d||""}</div>)})}</div><div style={{marginTop:8,display:"flex",gap:12,fontSize:11,fontFamily:ft,color:gw}}><span><span style={{display:"inline-block",width:10,height:10,borderRadius:3,background:"#f0f5e8",marginRight:4,verticalAlign:"middle"}}/>Con horarios</span><span><span style={{display:"inline-block",width:10,height:10,borderRadius:3,background:cp,marginRight:4,verticalAlign:"middle"}}/>Seleccionado</span></div></div>)}
function AlFlow(p){var a=p.al,aA=p.allAls,rd=p.rd,pm=Object.keys(a.mp||{}),pd=pm.length>0,_s=useState("menu"),sp=_s[0],sS=_s[1],_sl=useState(null),sl=_sl[0],sSl=_sl[1],_cm=useState(""),cm=_cm[0],sCm=_cm[1],_cr2=useState(true),cr2=_cr2[0],sCr=_cr2[1],_b=useState(false),by=_b[0],sB=_b[1],_cd=useState(null),cd=_cd[0],sCD=_cd[1];
useEffect(function(){sS("menu");sSl(null);sCm("");sCD(null)},[a.id]);
var nw=new Date(),cMk=nw.getFullYear()+"-"+nw.getMonth(),cSt=(a.mp||{})[cMk]?gMS(a,cMk):null;var nd=new Date(nw.getFullYear(),nw.getMonth()+1,1),nMk=nd.getFullYear()+"-"+nd.getMonth(),nSt=(a.mp||{})[nMk]?gMS(a,nMk):null;var tP=0;if(cSt)tP+=cSt.pn;if(nSt)tP+=nSt.pn;
function gUp(){var c=[];pm.forEach(function(mk){var pt=mk.split("-").map(Number),mc=cIM(a.turno.dia,a.turno.hora,pt[1],pt[0]),cm2=(a.canc||[]).filter(function(x){return x.mk===mk});mc.forEach(function(d){if(hU(d)>0&&!cm2.some(function(x){return x.iso===d.toISOString()}))c.push({date:d,mk:mk,isEx:false})})});(a.ex||[]).forEach(function(e){var d=new Date(e.date);if(hU(d)>0){var wc=(a.canc||[]).some(function(c){return c.iso===e.date&&c.isEx});if(!wc)c.push({date:d,mk:e.mk,isEx:true})}});return c.sort(function(a,b){return a.date-b.date})}
function gRM(){return[cMk,nMk].filter(function(k){return(a.mp||{})[k]})}
function gAS(){var sc=SC[a.sede];if(!sc)return[];var vm=gRM();if(!vm.length)return[];var al=[],ip=a.sede==="Palermo";sc.forEach(function(k){var pt=k.split("-");vm.forEach(function(mk){var p2=mk.split("-").map(Number);cIM(pt[0],pt[1],p2[1],p2[0]).forEach(function(d){if(hU(d)>24){if(ip){if(cFijos(aA,a.sede,pt[0],pt[1],d)===0)return}var c=gCupo(aA,a.sede,pt[0],pt[1],d);if(c.li>0)al.push({date:d,mk:mk,cl:c.li,di:pt[0],hr:pt[1]})}})})});var sn={};return al.filter(function(x){var k=x.date.toISOString();if(sn[k])return false;sn[k]=true;return true}).sort(function(a,b){return a.date-b.date})}
function gSF(dt){return dt?gAS().filter(function(s){return s.date.toDateString()===dt.toDateString()}):[]}
function gAD(){var s=gAS(),sn={},d=[];s.forEach(function(x){var k=x.date.toDateString();if(!sn[k]){sn[k]=true;d.push(x.date)}});return d}
async function doC(ci){sB(true);if(ci.isEx){await db("clases_extra","DELETE","?alumno_id=eq."+a.id+"&fecha_iso=eq."+encodeURIComponent(ci.date.toISOString()));await db("historial","POST","",{alumno_id:a.id,accion:"‚ùå Cancel√≥ recup "+fD(ci.date)});await rd();sB(false);sCr(true);sCm("")}else{var st=gMS(a,ci.mk),nr=st.i5&&st.cancT===0;await db("cancelaciones","POST","",{alumno_id:a.id,fecha_iso:ci.date.toISOString(),mes_key:ci.mk,sin_recuperacion:nr,sin_aviso:false,is_extra:false});await db("historial","POST","",{alumno_id:a.id,accion:(nr?"‚ùå(5ta) ":"‚ùå ")+fD(ci.date)});await rd();sB(false);if(nr){sCr(false);sCm("Esta clase no podr√≠as recuperarla ya que era tu 5ta clase regalo.\n\nSi cancel√°s alguna de tus 4 clases restantes con 24 hs de antelaci√≥n, podr√°s recuperarla.")}else{sCr(true);sCm("")}}}
async function doR(s,g){sB(true);await db("clases_extra","POST","",{alumno_id:a.id,fecha_iso:s.date.toISOString(),mes_key:s.mk,tipo:g?"regalo":"recuperacion"});await db("historial","POST","",{alumno_id:a.id,accion:(g?"üéÅ ":"üîÑ ")+fD(s.date)});if(g)await db("alumnos","PATCH","?id=eq."+a.id,{clase_regalo:Math.max(0,(a.reg||0)-1)});await rd();sB(false)}
async function doPN(){sB(true);await db("admin_notifs","POST","",{tipo:"pago",nombre:a.nombre,sede:a.sede,turno:a.turno.dia+" "+a.turno.hora});sB(false)}
function rst(){sS("menu");sSl(null);sCm("");sCr(true);sCD(null)}
var up=gUp(),ad=gAD(),sf=gSF(cd);
var bSt=function(d){return{padding:"12px 18px",borderRadius:10,cursor:d?"default":"pointer",fontSize:14,fontWeight:600,width:"100%",fontFamily:ft,background:d?cr:wh,color:d?gw:nv,border:"1px solid "+gb,textAlign:"left"}};
var bD={padding:"12px 18px",borderRadius:10,cursor:"pointer",fontSize:14,fontWeight:600,width:"100%",fontFamily:ft,background:"#fef2f2",color:"#991b1b",border:"1px solid #fca5a5",textAlign:"left"};
var bG={padding:"12px 18px",borderRadius:10,cursor:"pointer",fontSize:14,fontWeight:600,width:"100%",fontFamily:ft,background:"#fdf6ec",color:cp,border:"1px solid #e8d4b0",textAlign:"left"};
var bP={padding:"12px 18px",borderRadius:10,cursor:"pointer",fontSize:14,fontWeight:600,width:"100%",fontFamily:ft,background:cp,color:wh,border:"none",textAlign:"left"};
if(!pd)return(<div style={{padding:20,display:"flex",flexDirection:"column",gap:12,height:"100%",justifyContent:"center"}}><div style={{background:wh,borderRadius:14,padding:28,textAlign:"center",border:"1px solid "+gd}}><p style={{fontSize:44,margin:"0 0 10px"}}>‚è∏</p><h3 style={{color:nv,margin:"0 0 8px",fontFamily:ft}}>Acceso pausado</h3><p style={{color:gw,fontSize:14,margin:"0 0 24px",fontFamily:ft}}>Falta confirmar el pago.</p>{sp==="menu"?<button onClick={function(){doPN();sS("ps")}} disabled={by} style={bP}>{by?"Enviando...":"Ya hice el pago"}</button>:null}{sp==="ps"?<div style={{background:"#f0f5e8",borderRadius:10,padding:16}}><p style={{margin:0,color:"#5a6a2a",fontSize:14,fontFamily:ft}}>üëç ¬°Gracias! Le avisamos al equipo.</p><div style={{marginTop:12}}><button onClick={function(){sS("menu")}} style={bSt(false)}>‚Üê Volver</button></div></div>:null}</div></div>);
var pB=tP>0?<div style={{background:"#fdf6ec",borderRadius:10,padding:"10px 14px",border:"1px solid #e8d4b0",marginBottom:4}}><span style={{fontSize:14,color:cp,fontFamily:ft,fontWeight:600}}>{"üîÑ "+tP+" pendiente(s) de recuperar"}</span></div>:null;
return(<div style={{padding:18,display:"flex",flexDirection:"column",gap:10,overflowY:"auto",height:"100%"}}>
{sp==="menu"?<div style={{display:"flex",flexDirection:"column",gap:10}}><p style={{margin:0,color:nv,fontWeight:700,fontSize:17,fontFamily:ft}}>{"Hola "+a.nombre.split(" ")[0]+" ‚ú¶"}</p><p style={{margin:"0 0 4px",color:gw,fontSize:14,fontFamily:ft}}>¬øQu√© necesit√°s?</p>{pB}<button onClick={function(){sS("cp")}} style={bSt(false)}>‚ùå  Cancelar una clase</button>{tP>0?<button onClick={function(){sS("rp");sCD(null)}} style={bSt(false)}>{"üîÑ  Recuperar ("+tP+" pend.)"}</button>:<button disabled style={bSt(true)}>üîÑ  Recuperar (0 pend.)</button>}{a.reg>0?<button onClick={function(){sS("go");sCD(null)}} style={bG}>{"üéÅ  Regalo ("+a.reg+")"}</button>:null}</div>:null}
{sp==="cp"?<div style={{display:"flex",flexDirection:"column",gap:10}}><p style={{margin:0,color:nv,fontWeight:700,fontFamily:ft}}>¬øQu√© clase cancelar?</p>{up.map(function(c,i){var h=hU(c.date),bl=h<24;return<button key={i} disabled={bl} onClick={function(){if(!bl){sSl(c);sS("cc")}}} style={bSt(bl)}>{fD(c.date)+(c.isEx?" (recup)":"")+(bl?"  ¬∑ ‚ö† <24h":"")}</button>})}{up.some(function(c){return hU(c.date)<24&&hU(c.date)>0})?<div style={{background:"#fef2f2",borderRadius:10,padding:12,fontSize:13,color:"#991b1b",fontFamily:ft,border:"1px solid #fca5a5"}}>Lo siento mucho, no pod√©s cancelar esas clases ya que faltan menos de 24 hs.</div>:null}<button onClick={rst} style={bSt(false)}>‚Üê Volver</button></div>:null}
{sp==="cc"&&sl?<div style={{display:"flex",flexDirection:"column",gap:10}}><p style={{margin:0,color:nv,fontWeight:700,fontFamily:ft}}>¬øConfirm√°s cancelar?</p><div style={{background:"#fdf6ec",borderRadius:10,padding:14,textAlign:"center",fontSize:15,color:cp,fontWeight:600,fontFamily:ft,border:"1px solid #e8d4b0"}}>{fD(sl.date)}{sl.isEx?" (recup)":""}</div>{!sl.isEx&&(function(){var s=gMS(a,sl.mk);return s.i5&&s.cancT===0?<div style={{background:"#fdf6ec",borderRadius:10,padding:12,fontSize:13,color:"#92651e",fontFamily:ft,border:"1px solid #e8d4b0"}}>‚ö† 5ta clase regalo ‚Äî no se puede recuperar.</div>:null})()}<button disabled={by} onClick={function(){doC(sl).then(function(){sS("cd")})}} style={bD}>{by?"Cancelando...":"S√≠, cancelar"}</button><button onClick={function(){sS("cp")}} style={bSt(false)}>No, volver</button></div>:null}
{sp==="cd"?<div style={{display:"flex",flexDirection:"column",gap:10}}>{cr2?<div style={{display:"flex",flexDirection:"column",gap:10}}><div style={{background:"#f0f5e8",borderRadius:12,padding:20,textAlign:"center",border:"1px solid #b5c48a"}}><p style={{fontSize:36,margin:0}}>‚úì</p><p style={{margin:"8px 0 0",color:nv,fontWeight:700,fontFamily:ft,fontSize:16}}>Clase cancelada</p></div><p style={{margin:0,color:nv,fontWeight:600,fontFamily:ft,fontSize:14}}>¬øRecuperar ahora?</p><MCal onSelect={sCD} sel={cd} avail={ad}/>{cd?(sf.length>0?sf.map(function(s,i){return<button key={i} disabled={by} onClick={function(){doR(s).then(function(){sS("rd")})}} style={bSt(false)}>{s.hr+" ("+s.cl+" lugar"+(s.cl>1?"es":"")+")"}</button>}):<div style={{background:"#fdf6ec",borderRadius:10,padding:12,fontSize:13,color:"#92651e",fontFamily:ft,border:"1px solid #e8d4b0"}}>No hay opciones para este d√≠a</div>):null}<button onClick={rst} style={bSt(false)}>No, dejarlo as√≠</button></div>:<div style={{display:"flex",flexDirection:"column",gap:10}}><div style={{background:"#fdf6ec",borderRadius:12,padding:20,border:"1px solid #e8d4b0"}}><p style={{fontSize:32,margin:0,textAlign:"center"}}>‚ÑπÔ∏è</p><p style={{margin:"10px 0 0",color:nv,fontSize:14,fontFamily:ft,lineHeight:1.6}}>{cm}</p></div><button onClick={rst} style={bSt(false)}>Entendido</button></div>}</div>:null}
{sp==="rp"?<div style={{display:"flex",flexDirection:"column",gap:10}}><p style={{margin:0,color:nv,fontWeight:700,fontFamily:ft}}>Eleg√≠ un d√≠a:</p><p style={{margin:0,color:gw,fontSize:12,fontFamily:ft}}>Cupo m√°x: {MXC} ¬∑ Verde = disponible</p><MCal onSelect={sCD} sel={cd} avail={ad}/>{cd?(sf.length>0?sf.map(function(s,i){return<button key={i} disabled={by} onClick={function(){doR(s).then(function(){sS("rd")})}} style={bSt(false)}>{s.hr+" ("+s.cl+" lugar"+(s.cl>1?"es":"")+")"}</button>}):<div style={{background:"#fdf6ec",borderRadius:10,padding:12,fontSize:13,color:"#92651e",fontFamily:ft,border:"1px solid #e8d4b0"}}>No hay opciones para este d√≠a</div>):null}<button onClick={rst} style={bSt(false)}>‚Üê Volver</button></div>:null}
{sp==="rd"?<div style={{display:"flex",flexDirection:"column",gap:10}}><div style={{background:"#f0f5e8",borderRadius:12,padding:20,textAlign:"center",border:"1px solid #b5c48a"}}><p style={{fontSize:36,margin:0}}>‚úì</p><p style={{margin:"8px 0 0",color:nv,fontWeight:700,fontFamily:ft,fontSize:16}}>¬°Clase recuperada!</p><p style={{margin:"4px 0 0",color:gw,fontSize:13,fontFamily:ft}}>Ya aparece en tu calendario</p></div><button onClick={rst} style={bSt(false)}>Volver</button></div>:null}
{sp==="go"?<div style={{display:"flex",flexDirection:"column",gap:10}}><p style={{margin:0,color:nv,fontWeight:700,fontFamily:ft}}>üéÅ Eleg√≠ un d√≠a:</p><MCal onSelect={sCD} sel={cd} avail={ad}/>{cd?(sf.length>0?sf.map(function(s,i){return<button key={i} disabled={by} onClick={function(){doR(s,true).then(function(){sS("gd")})}} style={bG}>{s.hr+" ("+s.cl+" lugar"+(s.cl>1?"es":"")+")"}</button>}):<div style={{background:"#fdf6ec",borderRadius:10,padding:12,fontSize:13,color:"#92651e",fontFamily:ft,border:"1px solid #e8d4b0"}}>No hay opciones</div>):null}<button onClick={rst} style={bSt(false)}>‚Üê Volver</button></div>:null}
{sp==="gd"?<div style={{display:"flex",flexDirection:"column",gap:10}}><div style={{background:"#fdf6ec",borderRadius:12,padding:20,textAlign:"center",border:"1px solid #e8d4b0"}}><p style={{fontSize:36,margin:0}}>üéÅ</p><p style={{margin:"8px 0 0",color:cp,fontWeight:700,fontFamily:ft,fontSize:16}}>¬°Regalo confirmado!</p></div><button onClick={rst} style={bSt(false)}>Volver</button></div>:null}
</div>)}
export default function App(){var hash=useHash(),_a=useState([]),als=_a[0],sA=_a[1],_p=useState([]),prf=_p[0],sP=_p[1],_l=useState([]),lis=_l[0],sL=_l[1],_ld=useState(true),ld=_ld[0],sLd=_ld[1],_aa=useState(false),aa=_aa[0],sAa=_aa[1],_av=useState("chat"),av=_av[0],sAv=_av[1],_lg=useState(null),lg=_lg[0],sLg=_lg[1],_lp=useState(null),lp=_lp[0],sLp=_lp[1],_tb=useState("cal"),tb=_tb[0],sTb=_tb[1];
var lD=useCallback(async function(){try{var[ar,pr,pg,cn,ex,lr]=await Promise.all([db("alumnos","GET","?estado=eq.activo&order=nombre"),db("profesoras","GET","?order=nombre"),db("meses_pagados","GET"),db("cancelaciones","GET"),db("clases_extra","GET"),db("listas","GET")]);sA((ar||[]).map(function(r){return bAl(r,pg||[],cn||[],ex||[])}));sP((pr||[]).map(bPr));sL(lr||[])}catch(e){console.error("Load err:",e)}sLd(false)},[]);
useEffect(function(){lD()},[lD]);
async function rd(){await lD()}
var cu=lg?als.find(function(a){return a.id===lg.id}):null,cp2=lp?prf.find(function(p){return p.id===lp.id}):null;
useEffect(function(){if(lg&&cu)sLg(function(p){return p&&p.id===cu.id?cu:p})},[als]);
var rt="alumna";if(hash.includes("/admin"))rt="admin";else if(hash.includes("/profesora"))rt="profesora";
var aBS=function(ac){return{padding:"6px 14px",borderRadius:8,border:"none",cursor:"pointer",fontSize:13,fontWeight:600,fontFamily:ft,background:ac?gd:"rgba(255,255,255,0.1)",color:ac?nv:gb}};
if(ld)return<Loading/>;
return(<div style={{height:"100vh",display:"flex",flexDirection:"column",fontFamily:ft,background:cr}}>
<div style={{background:nv,color:cr,padding:"14px 18px",display:"flex",alignItems:"center",justifyContent:"space-between"}}><span style={{fontWeight:700,fontSize:19,letterSpacing:"0.5px",fontFamily:"'Instrument Serif',serif"}}>EVES POTTERY</span><div style={{display:"flex",gap:4,alignItems:"center"}}>{rt==="admin"&&aa?<>{(av==="alumna"&&lg)||(av==="profe"&&lp)?<button onClick={function(){sLg(null);sLp(null);sAv("chat")}} style={{padding:"6px 12px",borderRadius:8,border:"none",cursor:"pointer",fontSize:12,fontFamily:ft,background:"rgba(255,255,255,0.1)",color:gb,marginRight:4}}>‚Üê Panel</button>:null}<button onClick={function(){sAv("chat");sLg(null);sLp(null)}} style={aBS(av==="chat")}>Admin</button><button onClick={function(){sAv("alumna");sLg(null);sLp(null)}} style={aBS(av==="alumna")}>Ver alumna</button><button onClick={function(){sAv("profe");sLg(null);sLp(null)}} style={aBS(av==="profe")}>Ver profe</button><button onClick={function(){sAa(false);sAv("chat");sLg(null);sLp(null)}} style={{padding:"6px 12px",borderRadius:8,border:"none",cursor:"pointer",fontSize:12,fontFamily:ft,background:"rgba(255,255,255,0.1)",color:"#fca5a5",marginLeft:4}}>Salir</button></>:rt==="alumna"&&lg?<button onClick={function(){sLg(null);sTb("cal")}} style={{padding:"6px 12px",borderRadius:8,border:"none",cursor:"pointer",fontSize:12,fontFamily:ft,background:"rgba(255,255,255,0.1)",color:gb}}>Salir</button>:rt==="profesora"&&lp?<button onClick={function(){sLp(null)}} style={{padding:"6px 12px",borderRadius:8,border:"none",cursor:"pointer",fontSize:12,fontFamily:ft,background:"rgba(255,255,255,0.1)",color:gb}}>Salir</button>:null}</div></div>
{rt==="admin"?(!aa?<AdmLogin onLogin={function(){sAa(true)}}/>:av==="chat"?<div style={{flex:1,overflow:"hidden"}}><AdmChat als={als} rd={rd} prf={prf} lis={lis}/></div>:av==="alumna"?(!lg?<GLogin table="alumnos" onLogin={function(r){var a=als.find(function(x){return x.id===r.id});sLg(a||r);sTb("cal")}} subtitle="Seleccion√° alumna" skipPw={true} rd={rd}/>:<div style={{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"}}><div style={{padding:"10px 18px",background:wh,borderBottom:"1px solid "+gb}}><p style={{margin:0,fontWeight:700,color:nv,fontFamily:ft,fontSize:15}}>{cu?cu.nombre:""}</p><p style={{margin:0,color:gw,fontSize:12,fontFamily:ft}}>{cu?cu.sede+" ¬∑ "+cu.turno.dia+" "+cu.turno.hora:""}</p></div><div style={{display:"flex",borderBottom:"1px solid "+gb}}><button onClick={function(){sTb("cal")}} style={{flex:1,padding:"11px",border:"none",cursor:"pointer",fontSize:14,fontWeight:600,fontFamily:ft,background:tb==="cal"?wh:cr,color:tb==="cal"?nv:gw,borderBottom:tb==="cal"?"2px solid "+cp:"2px solid transparent"}}>üìÖ Clases</button><button onClick={function(){sTb("gest")}} style={{flex:1,padding:"11px",border:"none",cursor:"pointer",fontSize:14,fontWeight:600,fontFamily:ft,background:tb==="gest"?wh:cr,color:tb==="gest"?nv:gw,borderBottom:tb==="gest"?"2px solid "+cp:"2px solid transparent"}}>‚ö° Gestionar</button></div><div style={{flex:1,overflow:"auto",background:wh}}>{tb==="cal"&&cu?<AlCal al={cu}/>:null}{tb==="gest"&&cu?<AlFlow al={cu} allAls={als} rd={rd}/>:null}</div></div>):av==="profe"?(!lp?<GLogin table="profesoras" onLogin={function(r){var p=prf.find(function(x){return x.id===r.id});sLp(p||r)}} subtitle="Seleccion√° profesora" skipPw={true} rd={rd}/>:cp2?<PrfV profe={cp2} als={als} rd={rd} lis={lis}/>:null):null):rt==="profesora"?(!lp?<GLogin table="profesoras" onLogin={function(r){var p=prf.find(function(x){return x.id===r.id});if(p)sLp(p);else rd().then(function(){sLp(r)})}} subtitle="Acceso profesoras" rd={rd}/>:cp2?<PrfV profe={cp2} als={als} rd={rd} lis={lis}/>:null):(!lg?<GLogin table="alumnos" onLogin={function(r){var a=als.find(function(x){return x.id===r.id});if(a){sLg(a);sTb("cal")}else rd().then(function(){sLg(r);sTb("cal")})}} subtitle="Acced√© a tus clases" rd={rd}/>:<div style={{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"}}><div style={{padding:"10px 18px",background:wh,borderBottom:"1px solid "+gb}}><p style={{margin:0,fontWeight:700,color:nv,fontFamily:ft,fontSize:15}}>{cu?cu.nombre:""}</p><p style={{margin:0,color:gw,fontSize:12,fontFamily:ft}}>{cu?cu.sede+" ¬∑ "+cu.turno.dia+" "+cu.turno.hora:""}</p></div><div style={{display:"flex",borderBottom:"1px solid "+gb}}><button onClick={function(){sTb("cal")}} style={{flex:1,padding:"11px",border:"none",cursor:"pointer",fontSize:14,fontWeight:600,fontFamily:ft,background:tb==="cal"?wh:cr,color:tb==="cal"?nv:gw,borderBottom:tb==="cal"?"2px solid "+cp:"2px solid transparent"}}>üìÖ Clases</button><button onClick={function(){sTb("gest")}} style={{flex:1,padding:"11px",border:"none",cursor:"pointer",fontSize:14,fontWeight:600,fontFamily:ft,background:tb==="gest"?wh:cr,color:tb==="gest"?nv:gw,borderBottom:tb==="gest"?"2px solid "+cp:"2px solid transparent"}}>‚ö° Gestionar</button></div><div style={{flex:1,overflow:"auto",background:wh}}>{tb==="cal"&&cu?<AlCal al={cu}/>:null}{tb==="gest"&&cu?<AlFlow al={cu} allAls={als} rd={rd}/>:null}</div></div>)}
</div>)}
